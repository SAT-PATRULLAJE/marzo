<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SAT ‚Äì Sistema de An√°lisis Territorial</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>
<style>
  :root { --sat-muted:#6c757d; --sat-brand:#0d6efd; }
  body { font-size: 0.9rem; background:#f8f9fa; }
  .map-container { height: 440px; margin-bottom:16px; }
  .brand { font-weight:700; }
  .subtle { color: var(--sat-muted); }
  footer { font-size:0.8rem; text-align:center; margin:24px 0 8px; color:#666; }
  .btn-whatsapp { background:#25d366; color:white; font-weight:bold; }
  .badge-kpi { font-weight:600; font-size:.9rem; }
  .row-gap { row-gap: .75rem; }
  .table-sm td, .table-sm th { vertical-align: top; }
  .btn-toggle { min-width: 135px; }

  .leaflet-control.filter-chip {
    background: rgba(255,255,255,.92);
    border: 1px solid #dee2e6;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,.08);
    padding: 6px 10px;
    font-size: .85rem;
    max-width: 360px;
    line-height: 1.2;
  }
  .leaflet-control.filter-chip b { color: #0d6efd; }
</style>
</head>
<body class="container py-3">

  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-2">
    <h4 class="m-0 brand">SAT ‚Äì Sistema de An√°lisis Territorial <sup>¬©</sup></h4>
    <div class="text-end">
      <div class="small">CENTRO DE OPERACIONES</div>
      <div class="small">Corte: <span class="subtle">29/08/2025 04:41</span></div>
      <div class="small">
        Periodo (ALERTAS):
        <span class="subtle">
          01/03/2025 ‚Äì 31/03/2025
        </span>
        ¬∑ Eventos: <span class="subtle">186</span>
      </div>
    </div>
  </div>

  <div class="d-flex flex-wrap gap-2 mb-3">
    <span class="badge bg-primary badge-kpi">Alertas: <span id="kpiAlertas">20</span></span>
    <span class="badge bg-secondary badge-kpi">Eventos: <span id="kpiEventos">148</span></span>
    <span id="kpiDia" class="badge bg-info text-dark badge-kpi d-none">
      D√≠a: <span id="kpiDiaVal"></span>
    </span>
  </div>

  <!-- FILTROS -->
  <div class="row row-gap mb-2">
    <div class="col-6 col-md-3">
      <label class="form-label">Desde</label>
      <input type="date" id="fDesde" class="form-control form-control-sm">
    </div>
    <div class="col-6 col-md-3">
      <label class="form-label">Hasta</label>
      <input type="date" id="fHasta" class="form-control form-control-sm">
    </div>

    <div class="col-6 col-md-3">
      <label class="form-label">Distrito</label>
      <select id="fComis" class="form-select form-select-sm"><option value="">(todos)</option></select>
    </div>

    <div class="col-6 col-md-3">
      <label class="form-label">Franja</label>
      <select id="fFranja" class="form-select form-select-sm">
        <option value="">(todas)</option>
        <option>Madrugada</option>
        <option>Ma√±ana</option>
        <option>Tarde</option>
        <option>Noche</option>
      </select>
    </div>

    <div class="col-6 col-md-3">
      <label class="form-label">D√≠a</label>
      <select id="fDia" class="form-select form-select-sm">
        <option value="">(todos)</option>
        <option>Lunes</option>
        <option>Martes</option>
        <option>Mi√©rcoles</option>
        <option>Jueves</option>
        <option>Viernes</option>
        <option>S√°bado</option>
        <option>Domingo</option>
      </select>
    </div>

    <div class="col-6 col-md-3">
      <label class="form-label">Eventos (ventana)</label>
      <select id="fVentana" class="form-select form-select-sm">
        <option value="">(usar rango)</option>
        <option value="1">24 hs</option>
        <option value="2">48 hs</option>
        <option value="3">72 hs</option>
        <option value="7">7 d√≠as</option>
        <option value="15">15 d√≠as</option>
      </select>
    </div>
  </div>

  <!-- MAPA -->
  <div id="map" class="map-container border rounded"></div>

  <!-- TOGGLES -->
  <div class="d-flex flex-wrap gap-2 mb-3">
    <button class="btn btn-sm btn-outline-secondary btn-toggle" id="btnBase">üó∫Ô∏è OSM</button>
    <button class="btn btn-sm btn-outline-secondary btn-toggle" id="btnHybrid">üõ∞Ô∏è Sat√©lite + Calles</button>
    <button class="btn btn-sm btn-outline-primary btn-toggle" id="btnHeat">üî• Heatmap ON/OFF</button>
    <button class="btn btn-sm btn-outline-dark btn-toggle" id="btnPolys">‚¨õ Pol√≠gonos ON/OFF</button>
    <button class="btn btn-sm btn-outline-primary btn-toggle" id="btnCircles">üîµ C√≠rculos ON/OFF</button>
    <button class="btn btn-sm btn-outline-danger btn-toggle" id="btnDelitos">üî¥ Eventos Estudio ON/OFF</button>
  </div>

  <div class="d-flex align-items-center gap-2 mb-3">
    <label for="sPt" class="form-label m-0">Tama√±o puntos/heat</label>
    <input type="range" id="sPt" class="form-range" min="2" max="18" step="1" value="4" style="width:220px">
    <span id="sPtVal" class="small text-muted">4</span>
  </div>

  <!-- TABLA -->
  <div class="table-responsive">
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th>Distrito</th><th>Comisar√≠a</th><th>Zona</th><th>Franja</th>
          <th>Rango</th><th>Radio (m)</th><th>Eventos</th><th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

  <footer>
    ¬© SAT ‚Äì Sistema de An√°lisis Territorial | Lic. Sebasti√°n Gonz√°lez
  </footer>

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/wellknown@0.5.0/wellknown.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script>
  // ===== Datos inyectados desde Apps Script =====
  window.SAT = window.SAT || {};
  SAT.DATA    = [{"Alerta_ID":"ALR_500m_14/03/2025_-32.90392_-68.86179_5 // Zona Renato Della Santa 2155","Fecha":"2025-03-14T03:00:00.000Z","D√≠a":"Domingo (40%)","Franja":"üåÜ Noche (60%)","Rango_horario_total":"14:30‚Äì22:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":5,"Comisaria":"Comisaria 27","Distrito":"Villa Hipodromo","Zona_centroide":"Renato Della Santa 2155","Calles_triangulacion":"Pedro J. Godoy 1738 / Paso de los Andes 2215 / Renato Della Santa 2164 / Renato Della Santa 2187 / Paso de los Andes 2106","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.90378,-68.86372/-32.9035,-68.8603/-32.90403,-68.86246/-32.9038,-68.862/-32.90447,-68.86048","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.86372 -32.90378, -68.86048 -32.90447, -68.8603 -32.9035, -68.86372 -32.90378))","Centroide_lat":-32.903915999999995,"Centroide_lng":-68.86179200000001,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_09/03/2025_-32.90645_-68.87329_4 // Zona Lautaro 2363","Fecha":"2025-03-09T03:00:00.000Z","D√≠a":"Viernes (50%)","Franja":"üå§Ô∏è Ma√±ana (50%)","Rango_horario_total":"10:30‚Äì02:30","Rango_operativo_SAT":"06:00‚Äì11:59","Radio_m":500,"Cantidad_eventos":4,"Comisaria":"Comisaria 50","Distrito":"Villa del Parque","Zona_centroide":"Lautaro 2363","Calles_triangulacion":"Lautaro 2370 / Lautaro 2300 / Revolucion de Mayo 1779","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.90642,-68.87295/-32.90642,-68.87295/-32.90678,-68.8725/-32.90617,-68.87474","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.87474 -32.90617, -68.8725 -32.90678, -68.87295 -32.90642, -68.87474 -32.90617))","Centroide_lat":-32.9064475,"Centroide_lng":-68.87328500000001,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_15/03/2025_-32.92138_-68.85478_7 // Zona Carola Lorenzini 792","Fecha":"2025-03-15T03:00:00.000Z","D√≠a":"Domingo (43%)","Franja":"üåô Madrugada (57%)","Rango_horario_total":"02:30‚Äì02:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":7,"Comisaria":"Comisaria 27","Distrito":"Villa Hipodromo","Zona_centroide":"Carola Lorenzini 792","Calles_triangulacion":"Alfonsina Storni 312 / Anatole France 140 / Malvinas Argentinas 254 / Padre Arce 164 / Hungr√≠a 26 / Padre Arce 164 / Juana de Ibarbouru 401","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.92006,-68.85861/-32.92214,-68.85338/-32.92037,-68.85439/-32.92203,-68.8511/-32.92356,-68.85715/-32.92203,-68.8511/-32.91944,-68.85776","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.85861 -32.92006, -68.85715 -32.92356, -68.8511 -32.92203, -68.85439 -32.92037, -68.85776 -32.91944, -68.85861 -32.92006))","Centroide_lat":-32.921375714285716,"Centroide_lng":-68.85478428571427,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_03/03/2025_-32.90471_-68.84721_3 // Zona Echeverr√≠a 1927","Fecha":"2025-03-03T03:00:00.000Z","D√≠a":"Domingo (33%)","Franja":"üåÜ Noche (67%)","Rango_horario_total":"02:30‚Äì18:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":3,"Comisaria":"Comisaria 34","Distrito":"Centro","Zona_centroide":"Echeverr√≠a 1927","Calles_triangulacion":"25 de Mayo 310 / Santiago de Liniers 219","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.90493,-68.84765/-32.90493,-68.84765/-32.90428,-68.84632","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.84765 -32.90493, -68.84632 -32.90428, -68.84765 -32.90493))","Centroide_lat":-32.90471333333333,"Centroide_lng":-68.84720666666668,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_18/03/2025_-32.92285_-68.84538_6 // Zona Belgrano 200","Fecha":"2025-03-18T03:00:00.000Z","D√≠a":"Mi√©rcoles (33%)","Franja":"üåô Madrugada (50%)","Rango_horario_total":"22:30‚Äì02:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":6,"Comisaria":"Comisaria 34","Distrito":"Centro","Zona_centroide":"Belgrano 200","Calles_triangulacion":"Guido Spano 281 / Rivadavia 448 / Avenida San Mart√≠n 109 / Guido Spano 281 / Avenida San Mart√≠n Sur 375 / Belgrano 261","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.92163,-68.84445/-32.92513,-68.84323/-32.92273,-68.8478/-32.92163,-68.84445/-32.92445,-68.84852/-32.92152,-68.84385","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.84852 -32.92445, -68.84323 -32.92513, -68.84385 -32.92152, -68.84445 -32.92163, -68.8478 -32.92273, -68.84852 -32.92445))","Centroide_lat":-32.922848333333334,"Centroide_lng":-68.84538333333334,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_10/03/2025_-32.94376_-68.82556_8 // Zona Cerro Colorado 1874","Fecha":"2025-03-10T03:00:00.000Z","D√≠a":"Lunes (38%)","Franja":"üåô Madrugada (38%)","Rango_horario_total":"06:30‚Äì02:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":8,"Comisaria":"Comisaria 37","Distrito":"Las Tortugas","Zona_centroide":"Cerro Colorado 1874","Calles_triangulacion":"Tortugas 1386 / Cabo San Diego 1452 / V√©lez Sarsfield 1175 / Cerro Negro 1979 / Cerro Colorado 1957 / Triunvirato 1466 / Cabo San Diego 1452 / San Crist√≥bal 1671","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.94355,-68.82767/-32.946,-68.82474/-32.94288,-68.82469/-32.9434,-68.8232/-32.94363,-68.8232/-32.94486,-68.8295/-32.946,-68.82474/-32.93976,-68.82671","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.8295 -32.94486, -68.82474 -32.946, -68.8232 -32.94363, -68.8232 -32.9434, -68.82671 -32.93976, -68.8295 -32.94486))","Centroide_lat":-32.94376,"Centroide_lng":-68.82555625,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_19/03/2025_-32.94150_-68.83362_6 // Zona San Nicol√°s 1128","Fecha":"2025-03-19T03:00:00.000Z","D√≠a":"Lunes (33%)","Franja":"üåÜ Noche (50%)","Rango_horario_total":"10:30‚Äì18:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":6,"Comisaria":"Comisaria 37","Distrito":"Las Tortugas","Zona_centroide":"San Nicol√°s 1128","Calles_triangulacion":"Formosa 1133 / Tortugas 1091 / Primitivo de la Reta 933 / Cerro Tolosa 1433 / Formosa 1141 / Alem 1228","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.94118,-68.83345/-32.94508,-68.83404/-32.93761,-68.83365/-32.94281,-68.83226/-32.94123,-68.83336/-32.94107,-68.83497","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.83497 -32.94107, -68.83404 -32.94508, -68.83226 -32.94281, -68.83365 -32.93761, -68.83497 -32.94107))","Centroide_lat":-32.941496666666666,"Centroide_lng":-68.83362166666667,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_14/03/2025_-32.95003_-68.82910_10 // Zona V√©lez Sarsfield 1981","Fecha":"2025-03-14T03:00:00.000Z","D√≠a":"S√°bado (30%)","Franja":"üåô Madrugada (60%)","Rango_horario_total":"02:30‚Äì22:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":10,"Comisaria":"Comisaria 37","Distrito":"Las Tortugas","Zona_centroide":"V√©lez Sarsfield 1981","Calles_triangulacion":"Cabo Santa In√©s 1882 / Juan F. Terrada 2245 / Cabo San Sebasti√°n 1923 / V√©lez Sarsfield 1891 / Cabo Santa In√©s 1882 / Manuela Pedraza 1727 / Cabo San P√≠o 1635 / Arist√≥bulo Del Valle 1961","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.94998,-68.82957/-32.95302,-68.82682/-32.95087,-68.82842/-32.95048,-68.82893/-32.94998,-68.82957/-32.94887,-68.83062/-32.95088,-68.83275/-32.94891,-68.82675","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.83275 -32.95088, -68.82682 -32.95302, -68.82675 -32.94891, -68.83086 -32.94838, -68.83275 -32.95088))","Centroide_lat":-32.950027999999996,"Centroide_lng":-68.829104,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_13/03/2025_-32.94244_-68.81746_3 // Zona Domingo Matheu 2345","Fecha":"2025-03-13T03:00:00.000Z","D√≠a":"Domingo (33%)","Franja":"üåÜ Noche (67%)","Rango_horario_total":"22:30‚Äì10:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":3,"Comisaria":"Comisaria 37","Distrito":"San Fco del Monte","Zona_centroide":"Domingo Matheu 2345","Calles_triangulacion":"Darragueira 1020 / Julio Preciado 860","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.94289,-68.81628/-32.94289,-68.81628/-32.94155,-68.81982","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.81982 -32.94155, -68.81628 -32.94289, -68.81982 -32.94155))","Centroide_lat":-32.94244333333333,"Centroide_lng":-68.81746,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_13/03/2025_-32.94619_-68.85951_27 // Zona De la Esquina 1220","Fecha":"2025-03-13T03:00:00.000Z","D√≠a":"Domingo (30%)","Franja":"üåô Madrugada (56%)","Rango_horario_total":"02:30‚Äì22:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":27,"Comisaria":"Comisaria 40","Distrito":"Trapiche","Zona_centroide":"De la Esquina 1220","Calles_triangulacion":"Laguna de Las Quijadas 1252 / Laguna de Las Quijadas 1332 / Correntoso L. 1325 / De la Esquina 1264 / Laguna del Toro 1997 / Lago Palena 1996 / Lago Pulmar√≠ 1140 / Laguna del Toro 1997","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.94676,-68.85977/-32.9466,-68.8604/-32.94571,-68.86017/-32.94618,-68.85984/-32.94558,-68.8579/-32.94472,-68.86013/-32.94858,-68.85881/-32.94558,-68.8579","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.86249 -32.94766, -68.85881 -32.94858, -68.85699 -32.94787, -68.85613 -32.94384, -68.86141 -32.94258, -68.86249 -32.94766))","Centroide_lat":-32.94619407407408,"Centroide_lng":-68.85950703703703,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_14/03/2025_-32.93766_-68.87282_7 // Zona Calingasta 1276","Fecha":"2025-03-14T03:00:00.000Z","D√≠a":"Domingo (29%)","Franja":"üå§Ô∏è Ma√±ana (43%)","Rango_horario_total":"06:30‚Äì02:30","Rango_operativo_SAT":"06:00‚Äì11:59","Radio_m":500,"Cantidad_eventos":7,"Comisaria":"Comisaria 40","Distrito":"Villa Marini","Zona_centroide":"Calingasta 1276","Calles_triangulacion":"Caucete 1125 / Estrada 2304 / Santa Mar√≠a 1142 / Paz Gral. 2486 / Famatina 1222 / Valle Fertil 1234 / D. V. de Uco 1399-1499","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.93692,-68.87349/-32.9405,-68.87503/-32.93781,-68.87559/-32.93947,-68.87097/-32.93501,-68.8712/-32.93552,-68.87196/-32.93836,-68.87151","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.87559 -32.93781, -68.87503 -32.9405, -68.87097 -32.93947, -68.8712 -32.93501, -68.87559 -32.93781))","Centroide_lat":-32.93765571428572,"Centroide_lng":-68.87282142857143,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_12/03/2025_-32.93854_-68.85879_14 // Zona C√≥rdoba 959","Fecha":"2025-03-12T03:00:00.000Z","D√≠a":"Mi√©rcoles (36%)","Franja":"üåÜ Noche (64%)","Rango_horario_total":"22:30‚Äì22:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":14,"Comisaria":"Comisaria 40","Distrito":"Trapiche","Zona_centroide":"C√≥rdoba 959","Calles_triangulacion":"Espa√±a 1223 / Tiburcio Benegas 1002 / Los Robles 1399 / Los Platanos 1360 / Paul Grousac 1496 / Tiburcio Benegas 1002 / Espa√±a 1223","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.93744,-68.85711/-32.93744,-68.85711/-32.93827,-68.85962/-32.93903,-68.8611/-32.9394,-68.86187/-32.93882,-68.85914/-32.93827,-68.85962/-32.93744,-68.85711","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.86187 -32.9394, -68.8589 -32.94052, -68.85649 -32.94103, -68.85711 -32.93744, -68.86157 -32.93751, -68.86187 -32.9394))","Centroide_lat":-32.938545,"Centroide_lng":-68.85878500000001,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_17/03/2025_-32.94093_-68.86212_8 // Zona Pontevedra 1279","Fecha":"2025-03-17T03:00:00.000Z","D√≠a":"Domingo (25%)","Franja":"üå§Ô∏è Ma√±ana (38%)","Rango_horario_total":"14:30‚Äì18:30","Rango_operativo_SAT":"06:00‚Äì11:59","Radio_m":500,"Cantidad_eventos":8,"Comisaria":"Comisaria 40","Distrito":"Trapiche","Zona_centroide":"Pontevedra 1279","Calles_triangulacion":"Los Platanos 1360 / Paz Gral. 1400 / Los Platanos 1360 / Cartagena 1278 / Cartagena 1216 / Zaragoza 1849 / Pontevedra 1165 / Zaragoza 1849","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.93941,-68.86203/-32.93663,-68.86305/-32.93941,-68.86203/-32.94243,-68.8627/-32.94249,-68.86176/-32.94283,-68.86241/-32.94142,-68.86055/-32.94283,-68.86241","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.86305 -32.93663, -68.8627 -32.94243, -68.86241 -32.94283, -68.86176 -32.94249, -68.86055 -32.94142, -68.86305 -32.93663))","Centroide_lat":-32.94093125,"Centroide_lng":-68.86211750000001,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_04/03/2025_-32.93230_-68.85974_3 // Zona Paul Grousac 800","Fecha":"2025-03-04T03:00:00.000Z","D√≠a":"Martes (67%)","Franja":"üåô Madrugada (67%)","Rango_horario_total":"14:30‚Äì02:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":3,"Comisaria":"Comisaria 40","Distrito":"Villa Marini","Zona_centroide":"Paul Grousac 800","Calles_triangulacion":"Paul Grousac 895 / Espa√±a 670 / General Miguel Soler 705","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.93312,-68.86004/-32.93172,-68.85707/-32.93205,-68.8621","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.8621 -32.93205, -68.86004 -32.93312, -68.85707 -32.93172, -68.8621 -32.93205))","Centroide_lat":-32.932296666666666,"Centroide_lng":-68.85973666666666,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_25/03/2025_-32.92758_-68.85756_6 // Zona Espa√±a 335","Fecha":"2025-03-25T03:00:00.000Z","D√≠a":"Jueves (33%)","Franja":"üåÜ Noche (33%)","Rango_horario_total":"22:30‚Äì14:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":6,"Comisaria":"Comisaria 40","Distrito":"Villa Marini","Zona_centroide":"Espa√±a 335","Calles_triangulacion":"Italia 162 / Santa rosa Chacabuco 45 / Italia 162 / Espa√±a 381 / Santa rosa Chacabuco 45","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.92594,-68.85648/-32.92862,-68.85839/-32.92594,-68.85648/-32.92818,-68.85781/-32.92818,-68.85781/-32.92862,-68.85839","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.85839 -32.92862, -68.85781 -32.92818, -68.85648 -32.92594, -68.85839 -32.92862))","Centroide_lat":-32.92758,"Centroide_lng":-68.85755999999999,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_23/03/2025_-32.93272_-68.86676_4 // Zona Doctor Salvador Civit 1733","Fecha":"2025-03-23T03:00:00.000Z","D√≠a":"Domingo (50%)","Franja":"üå§Ô∏è Ma√±ana (50%)","Rango_horario_total":"06:30‚Äì02:30","Rango_operativo_SAT":"06:00‚Äì11:59","Radio_m":500,"Cantidad_eventos":4,"Comisaria":"Comisaria 40","Distrito":"Villa Marini","Zona_centroide":"Doctor Salvador Civit 1733","Calles_triangulacion":"Africa 477 / Ocean√≠a 1194 / Presidente Sarmiento 1889 / Africa 1137","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.92993,-68.8667/-32.93373,-68.86641/-32.93375,-68.86768/-32.93345,-68.86625","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.86768 -32.93375, -68.86641 -32.93373, -68.86625 -32.93345, -68.8667 -32.92993, -68.86768 -32.93375))","Centroide_lat":-32.932715,"Centroide_lng":-68.86676,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_07/03/2025_-32.90297_-68.88522_8 // Zona Bolivar 3359","Fecha":"2025-03-07T03:00:00.000Z","D√≠a":"Lunes (25%)","Franja":"üåô Madrugada (38%)","Rango_horario_total":"02:30‚Äì14:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":8,"Comisaria":"Comisaria 50","Distrito":"Villa del Parque","Zona_centroide":"Bolivar 3359","Calles_triangulacion":"Presidente Sarmiento 3366 / Bolivar 3415 / Chiclana 3460 / Lautaro 3382 / Presidente Sarmiento 2089 / La Paz 3253 / Presidente Sarmiento 3366 / Lautaro 3382","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.90245,-68.88457/-32.90304,-68.8867/-32.90315,-68.88812/-32.9044,-68.88573/-32.90324,-68.88303/-32.90062,-68.88328/-32.90245,-68.88457/-32.9044,-68.88573","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.88812 -32.90315, -68.88573 -32.9044, -68.88303 -32.90324, -68.88328 -32.90062, -68.88812 -32.90315))","Centroide_lat":-32.90296875,"Centroide_lng":-68.88521625,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_14/03/2025_-32.90450_-68.87826_10 // Zona Lamadrid 2864","Fecha":"2025-03-14T03:00:00.000Z","D√≠a":"Jueves (30%)","Franja":"üå§Ô∏è Ma√±ana (60%)","Rango_horario_total":"10:30‚Äì02:30","Rango_operativo_SAT":"06:00‚Äì11:59","Radio_m":500,"Cantidad_eventos":10,"Comisaria":"Comisaria 50","Distrito":"Villa del Parque","Zona_centroide":"Lamadrid 2864","Calles_triangulacion":"San Vicente 1950 / Ciudad de Viedma 2101 / Lautaro 2832 / Presidente Sarmiento 1850 / Ciudad de Viedma 1850 / San Vicente 1918","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.90397,-68.87757/-32.90251,-68.87836/-32.90481,-68.87831/-32.90473,-68.87889/-32.90499,-68.87913/-32.9051,-68.87912/-32.90471,-68.87781/-32.90471,-68.87781","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.87913 -32.90499, -68.87912 -32.9051, -68.87781 -32.90471, -68.87757 -32.90397, -68.87836 -32.90251, -68.87913 -32.90499))","Centroide_lat":-32.904495000000004,"Centroide_lng":-68.87826199999998,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_08/03/2025_-32.91639_-68.87384_6 // Zona Pedro Goyena 942","Fecha":"2025-03-08T03:00:00.000Z","D√≠a":"Lunes (33%)","Franja":"üåÜ Noche (50%)","Rango_horario_total":"18:30‚Äì06:30","Rango_operativo_SAT":"18:00‚Äì23:59","Radio_m":500,"Cantidad_eventos":6,"Comisaria":"Comisaria 50","Distrito":"Villa del Parque","Zona_centroide":"Pedro Goyena 942","Calles_triangulacion":"Carlos Paz 988 / Ascasubi 2680 / Chapanay 3022 / Pirovano 800 / Chapanay 3022 / Pedernera 2430","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.91543,-68.87301/-32.91562,-68.87346/-32.91852,-68.87664/-32.91727,-68.87277/-32.91852,-68.87664/-32.91297,-68.87052","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.87664 -32.91852, -68.87277 -32.91727, -68.87052 -32.91297, -68.87346 -32.91562, -68.87664 -32.91852))","Centroide_lat":-32.91638833333334,"Centroide_lng":-68.87384,"Eventos_puntos":""},{"Alerta_ID":"ALR_500m_10/03/2025_-32.91142_-68.87743_3 // Zona Chuquisaca 1436","Fecha":"2025-03-10T03:00:00.000Z","D√≠a":"Martes (67%)","Franja":"üåô Madrugada (67%)","Rango_horario_total":"18:30‚Äì02:30","Rango_operativo_SAT":"00:00‚Äì05:59","Radio_m":500,"Cantidad_eventos":3,"Comisaria":"Comisaria 50","Distrito":"Villa del Parque","Zona_centroide":"Chuquisaca 1436","Calles_triangulacion":"Chuquisaca 1466 / Pismanta 1434 / Am√©rica 2781","Link_GMaps_URL":"https://www.google.com/maps/dir/-32.91104,-68.8776/-32.91156,-68.87802/-32.91167,-68.87668","Link_Patrullaje_URL":"","Confiabilidad_leyenda":"Media (patr√≥n moderado / posible dispersi√≥n)","Poligono_WKT":"POLYGON((-68.87802 -32.91156, -68.87668 -32.91167, -68.8776 -32.91104, -68.87802 -32.91156))","Centroide_lat":-32.91142333333333,"Centroide_lng":-68.87743333333334,"Eventos_puntos":""}];
  SAT.DELITOS = [{"lat":-32.91409,"lng":-68.85833,"delito":"Intento de Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-05T01:30:00.000Z"},{"lat":-32.90378,"lng":-68.86372,"delito":"Consumo de Sustancias","jurisdiccion":"Comisaria 27","fecha":"2025-03-05T17:30:00.000Z"},{"lat":-32.90921,"lng":-68.85264,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 27","fecha":"2025-03-08T05:30:00.000Z"},{"lat":-32.90678,"lng":-68.8725,"delito":"Intento de Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-09T09:30:00.000Z"},{"lat":-32.9035,"lng":-68.8603,"delito":"Vandalismo","jurisdiccion":"Comisaria 27","fecha":"2025-03-14T01:30:00.000Z"},{"lat":-32.90403,"lng":-68.86246,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 27","fecha":"2025-03-14T09:30:00.000Z"},{"lat":-32.92037,"lng":-68.85439,"delito":"Intento de Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-15T01:30:00.000Z"},{"lat":-32.9038,"lng":-68.862,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 27","fecha":"2025-03-16T21:30:00.000Z"},{"lat":-32.90447,"lng":-68.86048,"delito":"Violencia de Genero","jurisdiccion":"Comisaria 27","fecha":"2025-03-17T01:30:00.000Z"},{"lat":-32.90691,"lng":-68.85367,"delito":"Robo de Moto","jurisdiccion":"Comisaria 27","fecha":"2025-03-18T01:30:00.000Z"},{"lat":-32.92203,"lng":-68.8511,"delito":"Intento de Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-21T09:30:00.000Z"},{"lat":-32.91944,"lng":-68.85776,"delito":"Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-23T05:30:00.000Z"},{"lat":-32.90916,"lng":-68.85919,"delito":"Robo","jurisdiccion":"Comisaria 27","fecha":"2025-03-23T05:30:00.000Z"},{"lat":-32.90493,"lng":-68.84765,"delito":"Ruidos Molestos/Auto","jurisdiccion":"Comisaria 34","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.90576,"lng":-68.83843,"delito":"Violencia de Genero","jurisdiccion":"Comisaria 34","fecha":"2025-03-03T21:30:00.000Z"},{"lat":-32.92163,"lng":-68.84445,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 34","fecha":"2025-03-04T01:30:00.000Z"},{"lat":-32.90493,"lng":-68.84765,"delito":"Disturbios/V√≠a p√∫blica","jurisdiccion":"Comisaria 34","fecha":"2025-03-04T01:30:00.000Z"},{"lat":-32.92006,"lng":-68.85861,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 34","fecha":"2025-03-04T05:30:00.000Z"},{"lat":-32.92513,"lng":-68.84323,"delito":"Intento de Robo","jurisdiccion":"Comisaria 34","fecha":"2025-03-05T05:30:00.000Z"},{"lat":-32.90428,"lng":-68.84632,"delito":"Robo de Comercio","jurisdiccion":"Comisaria 34","fecha":"2025-03-05T21:30:00.000Z"},{"lat":-32.92273,"lng":-68.8478,"delito":"Robo de ruedas","jurisdiccion":"Comisaria 34","fecha":"2025-03-06T01:30:00.000Z"},{"lat":-32.90847,"lng":-68.84194,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 34","fecha":"2025-03-15T21:30:00.000Z"},{"lat":-32.92163,"lng":-68.84445,"delito":"Intento de Robo","jurisdiccion":"Comisaria 34","fecha":"2025-03-18T05:30:00.000Z"},{"lat":-32.9166,"lng":-68.85735,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 34","fecha":"2025-03-18T21:30:00.000Z"},{"lat":-32.91761,"lng":-68.85045,"delito":"Robo de moto","jurisdiccion":"Comisaria 34","fecha":"2025-03-25T17:30:00.000Z"},{"lat":-32.91734,"lng":-68.85007,"delito":"Robo de moto","jurisdiccion":"Comisaria 34","fecha":"2025-03-25T17:30:00.000Z"},{"lat":-32.92152,"lng":-68.84385,"delito":"Intento de Robo","jurisdiccion":"Comisaria 34","fecha":"2025-03-30T05:30:00.000Z"},{"lat":-32.94355,"lng":-68.82767,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-03T09:30:00.000Z"},{"lat":-32.94118,"lng":-68.83345,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-03T13:30:00.000Z"},{"lat":-32.9576,"lng":-68.84978,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-03T17:30:00.000Z"},{"lat":-32.94866,"lng":-68.84138,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-06T01:30:00.000Z"},{"lat":-32.94508,"lng":-68.83404,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-08T09:30:00.000Z"},{"lat":-32.95087,"lng":-68.82842,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-09T01:30:00.000Z"},{"lat":-32.94288,"lng":-68.82469,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-09T05:30:00.000Z"},{"lat":-32.95048,"lng":-68.82893,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-09T17:30:00.000Z"},{"lat":-32.94289,"lng":-68.81628,"delito":"Sensor","jurisdiccion":"Comisaria 37","fecha":"2025-03-10T01:30:00.000Z"},{"lat":-32.95618,"lng":-68.8396,"delito":"Robo de cobre","jurisdiccion":"Comisaria 37","fecha":"2025-03-11T21:30:00.000Z"},{"lat":-32.94486,"lng":-68.8295,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-12T01:30:00.000Z"},{"lat":-32.94998,"lng":-68.82957,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-12T05:30:00.000Z"},{"lat":-32.94289,"lng":-68.81628,"delito":"Sensor","jurisdiccion":"Comisaria 37","fecha":"2025-03-14T01:30:00.000Z"},{"lat":-32.94887,"lng":-68.83062,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-14T09:30:00.000Z"},{"lat":-32.946,"lng":-68.82474,"delito":"Intento de Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-15T09:30:00.000Z"},{"lat":-32.94044,"lng":-68.82359,"delito":"Sensor","jurisdiccion":"Comisaria 37","fecha":"2025-03-17T05:30:00.000Z"},{"lat":-32.93761,"lng":-68.83365,"delito":"Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-18T01:30:00.000Z"},{"lat":-32.95088,"lng":-68.83275,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-20T05:30:00.000Z"},{"lat":-32.94123,"lng":-68.83336,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-21T01:30:00.000Z"},{"lat":-32.93976,"lng":-68.82671,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-21T05:30:00.000Z"},{"lat":-32.93487,"lng":-68.83884,"delito":"Robo","jurisdiccion":"Comisaria 37","fecha":"2025-03-25T01:30:00.000Z"},{"lat":-32.94155,"lng":-68.81982,"delito":"Emergencia","jurisdiccion":"Comisaria 37","fecha":"2025-03-25T13:30:00.000Z"},{"lat":-32.94107,"lng":-68.83497,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-26T21:30:00.000Z"},{"lat":-32.93688,"lng":-68.83187,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 37","fecha":"2025-03-27T01:30:00.000Z"},{"lat":-32.94676,"lng":-68.85977,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.9466,"lng":-68.8604,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.94571,"lng":-68.86017,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.94618,"lng":-68.85984,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.93692,"lng":-68.87349,"delito":"Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T09:30:00.000Z"},{"lat":-32.93744,"lng":-68.85711,"delito":"Ruidos Molestos/Volumen Musica","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T09:30:00.000Z"},{"lat":-32.93827,"lng":-68.85962,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T13:30:00.000Z"},{"lat":-32.93941,"lng":-68.86203,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-02T17:30:00.000Z"},{"lat":-32.93312,"lng":-68.86004,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-03T17:30:00.000Z"},{"lat":-32.93903,"lng":-68.8611,"delito":"Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-03T21:30:00.000Z"},{"lat":-32.94558,"lng":-68.8579,"delito":"Sensor","jurisdiccion":"Comisaria 40","fecha":"2025-03-04T05:30:00.000Z"},{"lat":-32.93172,"lng":-68.85707,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-04T05:30:00.000Z"},{"lat":-32.93941,"lng":-68.86203,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-04T13:30:00.000Z"},{"lat":-32.9394,"lng":-68.86187,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-06T01:30:00.000Z"},{"lat":-32.94472,"lng":-68.86013,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-06T05:30:00.000Z"},{"lat":-32.94858,"lng":-68.85881,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-06T09:30:00.000Z"},{"lat":-32.92594,"lng":-68.85648,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-07T01:30:00.000Z"},{"lat":-32.94558,"lng":-68.8579,"delito":"Sensor","jurisdiccion":"Comisaria 40","fecha":"2025-03-07T01:30:00.000Z"},{"lat":-32.93882,"lng":-68.85914,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-07T09:30:00.000Z"},{"lat":-32.94243,"lng":-68.8627,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-07T09:30:00.000Z"},{"lat":-32.94738,"lng":-68.86008,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-08T05:30:00.000Z"},{"lat":-32.94558,"lng":-68.8579,"delito":"Sensor","jurisdiccion":"Comisaria 40","fecha":"2025-03-10T05:30:00.000Z"},{"lat":-32.93827,"lng":-68.85962,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-10T13:30:00.000Z"},{"lat":-32.9454,"lng":-68.85951,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-10T17:30:00.000Z"},{"lat":-32.94496,"lng":-68.85977,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-11T05:30:00.000Z"},{"lat":-32.94451,"lng":-68.87439,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-12T05:30:00.000Z"},{"lat":-32.9405,"lng":-68.87503,"delito":"Emergencia","jurisdiccion":"Comisaria 40","fecha":"2025-03-12T17:30:00.000Z"},{"lat":-32.93744,"lng":-68.85711,"delito":"Disturbios/V√≠a p√∫blica","jurisdiccion":"Comisaria 40","fecha":"2025-03-13T01:30:00.000Z"},{"lat":-32.92993,"lng":-68.8667,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-13T09:30:00.000Z"},{"lat":-32.94258,"lng":-68.86141,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-13T21:30:00.000Z"},{"lat":-32.94384,"lng":-68.85613,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-14T01:30:00.000Z"},{"lat":-32.93781,"lng":-68.87559,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-14T01:30:00.000Z"},{"lat":-32.93947,"lng":-68.87097,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-15T01:30:00.000Z"},{"lat":0,"lng":0,"delito":"Ruidos Molestos","jurisdiccion":"Comisaria 40","fecha":"2025-03-15T09:30:00.000Z"},{"lat":-32.92356,"lng":-68.85715,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-16T05:30:00.000Z"},{"lat":-32.93501,"lng":-68.8712,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-16T13:30:00.000Z"},{"lat":-32.93373,"lng":-68.86641,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-16T21:30:00.000Z"},{"lat":-32.94249,"lng":-68.86176,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-17T05:30:00.000Z"},{"lat":-32.94283,"lng":-68.86241,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-17T13:30:00.000Z"},{"lat":-32.93205,"lng":-68.8621,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-18T05:30:00.000Z"},{"lat":-32.94052,"lng":-68.8589,"delito":"Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-18T21:30:00.000Z"},{"lat":-32.94507,"lng":-68.85959,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-19T01:30:00.000Z"},{"lat":-32.94142,"lng":-68.86055,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-19T05:30:00.000Z"},{"lat":-32.92862,"lng":-68.85839,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-19T05:30:00.000Z"},{"lat":-32.93552,"lng":-68.87196,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-19T09:30:00.000Z"},{"lat":-32.94283,"lng":-68.86241,"delito":"Consumo de Sustancias","jurisdiccion":"Comisaria 40","fecha":"2025-03-19T21:30:00.000Z"},{"lat":-32.94103,"lng":-68.85649,"delito":"Pers/situacion de calle","jurisdiccion":"Comisaria 40","fecha":"2025-03-20T01:30:00.000Z"},{"lat":-32.93744,"lng":-68.85711,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-20T01:30:00.000Z"},{"lat":-32.93836,"lng":-68.87151,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-20T05:30:00.000Z"},{"lat":-32.94502,"lng":-68.85891,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-23T05:30:00.000Z"},{"lat":-32.93375,"lng":-68.86768,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-23T09:30:00.000Z"},{"lat":-32.92594,"lng":-68.85648,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-23T13:30:00.000Z"},{"lat":-32.93958,"lng":-68.85913,"delito":"Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-24T05:30:00.000Z"},{"lat":-32.94738,"lng":-68.86008,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-25T01:30:00.000Z"},{"lat":-32.94723,"lng":-68.86981,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-25T05:30:00.000Z"},{"lat":-32.94715,"lng":-68.86004,"delito":"Violencia de Genero","jurisdiccion":"Comisaria 40","fecha":"2025-03-25T17:30:00.000Z"},{"lat":-32.92818,"lng":-68.85781,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-25T21:30:00.000Z"},{"lat":-32.94787,"lng":-68.85699,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-26T05:30:00.000Z"},{"lat":-32.92818,"lng":-68.85781,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-26T13:30:00.000Z"},{"lat":-32.94653,"lng":-68.85842,"delito":"Pers/situacion de calle","jurisdiccion":"Comisaria 40","fecha":"2025-03-26T21:30:00.000Z"},{"lat":-32.94558,"lng":-68.8579,"delito":"Sensor","jurisdiccion":"Comisaria 40","fecha":"2025-03-27T05:30:00.000Z"},{"lat":-32.92445,"lng":-68.84852,"delito":"Robo de Bicicleta","jurisdiccion":"Comisaria 40","fecha":"2025-03-28T17:30:00.000Z"},{"lat":-32.93345,"lng":-68.86625,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-29T05:30:00.000Z"},{"lat":-32.94676,"lng":-68.85977,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-30T05:30:00.000Z"},{"lat":-32.94766,"lng":-68.86249,"delito":"Intento de Robo","jurisdiccion":"Comisaria 40","fecha":"2025-03-30T05:30:00.000Z"},{"lat":-32.94766,"lng":-68.86249,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-30T09:30:00.000Z"},{"lat":-32.94766,"lng":-68.86249,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-03-31T05:30:00.000Z"},{"lat":-32.94843,"lng":-68.85889,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 40","fecha":"2025-04-01T01:30:00.000Z"},{"lat":-32.90245,"lng":-68.88457,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.90397,"lng":-68.87757,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-02T13:30:00.000Z"},{"lat":-32.90304,"lng":-68.8867,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-03T09:30:00.000Z"},{"lat":-32.91543,"lng":-68.87301,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-03T21:30:00.000Z"},{"lat":-32.91562,"lng":-68.87346,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-04T01:30:00.000Z"},{"lat":-32.91104,"lng":-68.8776,"delito":"Vandalismo","jurisdiccion":"Comisaria 50","fecha":"2025-03-04T21:30:00.000Z"},{"lat":-32.91121,"lng":-68.87077,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-05T01:30:00.000Z"},{"lat":-32.91852,"lng":-68.87664,"delito":"Emergencia","jurisdiccion":"Comisaria 50","fecha":"2025-03-05T17:30:00.000Z"},{"lat":-32.90251,"lng":-68.87836,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-05T21:30:00.000Z"},{"lat":-32.90315,"lng":-68.88812,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-06T05:30:00.000Z"},{"lat":-32.9044,"lng":-68.88573,"delito":"intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-06T05:30:00.000Z"},{"lat":-32.90642,"lng":-68.87295,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-07T13:30:00.000Z"},{"lat":-32.90324,"lng":-68.88303,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-07T13:30:00.000Z"},{"lat":-32.90642,"lng":-68.87295,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-07T17:30:00.000Z"},{"lat":-32.91727,"lng":-68.87277,"delito":"Pers/situacion de calle","jurisdiccion":"Comisaria 50","fecha":"2025-03-09T01:30:00.000Z"},{"lat":-32.90481,"lng":-68.87831,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-09T01:30:00.000Z"},{"lat":-32.91156,"lng":-68.87802,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-10T05:30:00.000Z"},{"lat":-32.91852,"lng":-68.87664,"delito":"Ruidos Molestos","jurisdiccion":"Comisaria 50","fecha":"2025-03-11T05:30:00.000Z"},{"lat":-32.90617,"lng":-68.87474,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-12T05:30:00.000Z"},{"lat":-32.90473,"lng":-68.87889,"delito":"Robo de ruedas","jurisdiccion":"Comisaria 50","fecha":"2025-03-13T09:30:00.000Z"},{"lat":-32.91297,"lng":-68.87052,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-13T09:30:00.000Z"},{"lat":-32.90499,"lng":-68.87913,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-13T17:30:00.000Z"},{"lat":-32.93132,"lng":-68.89255,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-14T05:30:00.000Z"},{"lat":-32.9051,"lng":-68.87912,"delito":"Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-14T13:30:00.000Z"},{"lat":-32.90008,"lng":-32.90008,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-14T17:30:00.000Z"},{"lat":-32.91156,"lng":-32.91156,"delito":"Ri√±a","jurisdiccion":"Comisaria 50","fecha":"2025-03-15T05:30:00.000Z"},{"lat":-32.90062,"lng":-68.88328,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-16T01:30:00.000Z"},{"lat":-32.90223,"lng":-68.86927,"delito":"Disturbios","jurisdiccion":"Comisaria 50","fecha":"2025-03-16T17:30:00.000Z"},{"lat":-32.91167,"lng":-68.87668,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-18T05:30:00.000Z"},{"lat":-32.90245,"lng":-68.88457,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-25T13:30:00.000Z"},{"lat":-32.90471,"lng":-68.87781,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-26T09:30:00.000Z"},{"lat":-32.90471,"lng":-68.87781,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-27T09:30:00.000Z"},{"lat":-32.92862,"lng":-68.85839,"delito":"Consumo de Sustancias","jurisdiccion":"Comisaria 50","fecha":"2025-03-27T17:30:00.000Z"},{"lat":-32.90471,"lng":-68.87781,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-28T09:30:00.000Z"},{"lat":-32.93132,"lng":-68.89255,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 50","fecha":"2025-03-30T09:30:00.000Z"},{"lat":-32.90471,"lng":-68.87781,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-31T05:30:00.000Z"},{"lat":-32.9044,"lng":-68.88573,"delito":"Intento de Robo","jurisdiccion":"Comisaria 50","fecha":"2025-03-31T17:30:00.000Z"},{"lat":-32.94998,"lng":-68.82957,"delito":"Intento de Robo","jurisdiccion":"Comisaria 52","fecha":"2025-03-02T05:30:00.000Z"},{"lat":-32.95302,"lng":-68.82682,"delito":"Tiroteo","jurisdiccion":"Comisaria 52","fecha":"2025-03-03T05:30:00.000Z"},{"lat":-32.946,"lng":-68.82474,"delito":"Ri√±a","jurisdiccion":"Comisaria 52","fecha":"2025-03-04T05:30:00.000Z"},{"lat":-32.92604,"lng":-68.84278,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 52","fecha":"2025-03-08T09:30:00.000Z"},{"lat":-32.9434,"lng":-68.8232,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 52","fecha":"2025-03-11T01:30:00.000Z"},{"lat":-32.94363,"lng":-68.8232,"delito":"Ruidos Molestos","jurisdiccion":"Comisaria 52","fecha":"2025-03-11T01:30:00.000Z"},{"lat":-32.95115,"lng":-68.84326,"delito":"Intento de Robo","jurisdiccion":"Comisaria 52","fecha":"2025-03-17T01:30:00.000Z"},{"lat":-32.94557,"lng":-68.82116,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 52","fecha":"2025-03-17T17:30:00.000Z"},{"lat":-32.94281,"lng":-68.83226,"delito":"Pers/situacion de calle","jurisdiccion":"Comisaria 52","fecha":"2025-03-19T05:30:00.000Z"},{"lat":-32.95314,"lng":-68.84344,"delito":"Intento de Robo","jurisdiccion":"Comisaria 52","fecha":"2025-03-19T09:30:00.000Z"},{"lat":-32.95581,"lng":-68.83172,"delito":"tel√©fono mal cargado","jurisdiccion":"Comisaria 52","fecha":"2025-03-20T05:30:00.000Z"},{"lat":-32.94891,"lng":-68.82675,"delito":"Intento de Robo","jurisdiccion":"Comisaria 52","fecha":"2025-03-22T05:30:00.000Z"},{"lat":-32.94838,"lng":-68.83086,"delito":"Vandalismo","jurisdiccion":"Comisaria 52","fecha":"2025-03-22T05:30:00.000Z"},{"lat":-32.94955,"lng":-68.8224,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 52","fecha":"2025-03-22T09:30:00.000Z"},{"lat":-32.94891,"lng":-68.82675,"delito":"Vandalismo","jurisdiccion":"Comisaria 52","fecha":"2025-03-28T01:30:00.000Z"},{"lat":-32.93744,"lng":-68.85711,"delito":"Ruidos Molestos","jurisdiccion":"Comisaria 7","fecha":"2025-03-02T01:30:00.000Z"},{"lat":-32.93663,"lng":-68.86305,"delito":"Intento de Robo","jurisdiccion":"Comisaria 7","fecha":"2025-03-02T17:30:00.000Z"},{"lat":-32.93653,"lng":-68.8496,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 7","fecha":"2025-03-02T21:30:00.000Z"},{"lat":-32.92351,"lng":-68.8497,"delito":"Vandalismo","jurisdiccion":"Comisaria 7","fecha":"2025-03-05T01:30:00.000Z"},{"lat":-32.92214,"lng":-68.85338,"delito":"Robo de Bicicleta","jurisdiccion":"Comisaria 7","fecha":"2025-03-09T17:30:00.000Z"},{"lat":-32.92203,"lng":-68.8511,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 7","fecha":"2025-03-15T05:30:00.000Z"},{"lat":-32.93744,"lng":-68.85711,"delito":"Ruidos Molestos","jurisdiccion":"Comisaria 7","fecha":"2025-03-27T01:30:00.000Z"},{"lat":-32.92883,"lng":-68.84204,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 7","fecha":"2025-03-28T05:30:00.000Z"},{"lat":-32.93204,"lng":-68.84137,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 7","fecha":"2025-03-28T09:30:00.000Z"},{"lat":-32.93751,"lng":-68.86157,"delito":"Situacion Sospechosa","jurisdiccion":"Comisaria 7","fecha":"2025-04-01T01:30:00.000Z"},{"lat":-32.94333,"lng":-68.84487,"delito":"Robo de Bicicleta","jurisdiccion":"Subc Benegas","fecha":"2025-03-10T21:30:00.000Z"},{"lat":-32.93868,"lng":-68.8433,"delito":"Situacion Sospechosa","jurisdiccion":"Subcomisaria Benegas","fecha":"2025-03-04T17:30:00.000Z"},{"lat":-32.93997,"lng":-68.84301,"delito":"Pers/situacion de calle","jurisdiccion":"Subcomisaria Benegas","fecha":"2025-03-05T05:30:00.000Z"},{"lat":-32.94502,"lng":-68.85891,"delito":"Situacion Sospechosa","jurisdiccion":"Subcomisaria Benegas","fecha":"2025-03-25T21:30:00.000Z"},{"lat":-32.93871,"lng":-68.82619,"delito":"Intento de Robo","jurisdiccion":"ZIM","fecha":"2025-03-07T13:30:00.000Z"}];
  SAT.PERIOD  = {"desdeISO":"2025-03-01","hastaISO":"2025-03-31","desdeLbl":"01/03/2025","hastaLbl":"31/03/2025","eventos":186};
  if (typeof window.DATA === 'undefined')        window.DATA = SAT.DATA;
  if (typeof window.DELITOS_DATA === 'undefined')window.DELITOS_DATA = SAT.DELITOS;
  if (typeof window.PERIOD === 'undefined')      window.PERIOD = SAT.PERIOD;

  // ===== estado UI/Tabla =====
  let LAST_ROWS = [];
  let delitosDaysLimit = null;
  let filteredDelitosDays = Array.isArray(DELITOS_DATA) ? DELITOS_DATA.slice() : [];

  let POINT_RADIUS = 4;
  let HEAT_RADIUS  = 28;

  function setBtnState(id, active){
    const el = document.getElementById(id);
    if (!el) return;
    var outline = null;
    var classes = el.classList ? Array.from(el.classList) : [];
    for (var i=0;i<classes.length;i++){ if (classes[i].indexOf('btn-outline-')===0){ outline = classes[i]; break; } }
    if (!outline) return;
    const solid = outline.replace('btn-outline-','btn-');
    if (active){ el.classList.remove(outline); el.classList.add(solid); }
    else { el.classList.remove(solid); el.classList.add(outline); }
  }

  function fmtFecha(iso){
    if (!iso) return '';
    try {
      var d = new Date(iso);
      return d.toLocaleDateString('es-AR') + ' ' + d.toLocaleTimeString('es-AR',{hour:'2-digit',minute:'2-digit'});
    } catch(e){ return ''; }
  }
  function openURL(u){ window.open(u, "_blank"); }
  function isValidDate(d){ return d && !isNaN(+new Date(d)); }

  // ===== filtros din√°micos =====
  const fComis   = document.getElementById('fComis');
  const fDesdeEl = document.getElementById('fDesde');
  const fHastaEl = document.getElementById('fHasta');
  const fVentEl  = document.getElementById('fVentana');

  const uniq = (arr) => Array.from(new Set(arr)).filter(function(x){return !!x;}).sort();
  uniq(DATA.map(function(r){ return r.Distrito; })).forEach(function(v){ fComis.innerHTML += '<option>'+v+'</option>'; });

  if (PERIOD.desdeISO) fDesdeEl.value = PERIOD.desdeISO;
  if (PERIOD.hastaISO) fHastaEl.value = PERIOD.hastaISO;

  fDesdeEl.addEventListener('change', renderAll);
  fHastaEl.addEventListener('change', renderAll);
  fComis.addEventListener('change', renderAll);
  document.getElementById('fFranja').addEventListener('change', renderAll);
  document.getElementById('fDia').addEventListener('change', renderAll);

  fVentEl.addEventListener('change', function(){
    var v = fVentEl.value;
    delitosDaysLimit = v ? parseInt(v, 10) : null;
    renderAll();
  });

  const sPt = document.getElementById('sPt');
  const sPtVal = document.getElementById('sPtVal');
  if (sPt) {
    sPt.addEventListener('input', function(){
      POINT_RADIUS = parseInt(sPt.value,10) || 4;
      HEAT_RADIUS  = Math.max(12, Math.round(POINT_RADIUS * 7));
      if (sPtVal) sPtVal.textContent = POINT_RADIUS;

      if (delitosLayer && map.hasLayer(delitosLayer)) {
        map.removeLayer(delitosLayer);
        delitosLayer = makeDelitosLayer(filteredDelitosDays).addTo(map);
        setBtnState('btnDelitos', true);
      } else {
        delitosLayer = makeDelitosLayer(filteredDelitosDays);
      }
      if (heatLayer && map.hasLayer(heatLayer)) {
        map.removeLayer(heatLayer);
        heatLayer = L.heatLayer(buildHeatDataDelitos(filteredDelitosDays), {radius:HEAT_RADIUS, blur:15, maxZoom:18}).addTo(map);
        setBtnState('btnHeat', true);
      }
    });
  }

  function dayCanonical(s){
    var t = String(s||'')
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
      .toLowerCase()
      .replace(/[+%()]/g,' ')
      .replace(/\d+/g,' ')
      .replace(/\s+/g,' ')
      .trim();
    if (t.indexOf('lun')>-1) return 'lunes';
    if (t.indexOf('mar')>-1) return 'martes';
    if (t.indexOf('mie')>-1) return 'miercoles';
    if (t.indexOf('jue')>-1) return 'jueves';
    if (t.indexOf('vie')>-1) return 'viernes';
    if (t.indexOf('sab')>-1) return 'sabado';
    if (t.indexOf('dom')>-1) return 'domingo';
    return '';
  }

  function filterRows() {
    var dDesde = fDesdeEl.value;
    var dHasta = fHastaEl.value;
    var distritoSel  = fComis.value || '';
    var diaSel = document.getElementById('fDia').value || '';
    var franja = (document.getElementById('fFranja').value || '');

    var norm = function(s){ return String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase(); };
    var canonical = function(s){
      var t = norm(s);
      if (t.indexOf('madrug')>-1) return 'madrugada';
      if (t.indexOf('manana')>-1 || t.indexOf('ma√±ana')>-1) return 'ma√±ana';
      if (t.indexOf('tarde')>-1)  return 'tarde';
      if (t.indexOf('noche')>-1)  return 'noche';
      return '';
    };

    return DATA.filter(function(r){
      if (dDesde) { if (!r.Fecha || new Date(r.Fecha) < new Date(dDesde + 'T00:00:00')) return false; }
      if (dHasta) { if (!r.Fecha || new Date(r.Fecha) > new Date(dHasta + 'T23:59:59')) return false; }
      if (distritoSel && r.Distrito !== distritoSel) return false;

      if (franja) {
        var can = canonical(r.Franja || '');
        if (!can || canonical(franja) !== can) return false;
      }

      if (diaSel) {
        var dRow = dayCanonical(r.D√≠a || r.Dia || '');
        if (!dRow || dRow !== dayCanonical(diaSel)) return false;
      }

      return true;
    });
  }

  // ===== Delitos de Estudio (ahora textos ‚ÄúEventos‚Äù) =====
  function currentDateRange(){
    var ds = fDesdeEl.value;
    var hs = fHastaEl.value;
    var d1 = ds ? new Date(ds + 'T00:00:00') : null;
    var d2 = hs ? new Date(hs + 'T23:59:59') : null;
    return [d1, d2];
  }

  function getFilteredDelitos(){
    if (!Array.isArray(DELITOS_DATA)) return [];
    var dr = currentDateRange();
    var d1 = dr[0], d2 = dr[1];
    var now = new Date();
    return DELITOS_DATA.filter(function(p){
      if (!p || !isFinite(p.lat) || !isFinite(p.lng)) return false;
      if (!p.fecha || !isValidDate(p.fecha)) return true;
      var f = new Date(p.fecha);
      if (d1 && f < d1) return false;
      if (d2 && f > d2) return false;
      if (delitosDaysLimit != null) {
        var diff = (now - f) / (1000*60*60*24);
        if (diff > delitosDaysLimit) return false;
      }
      return true;
    });
  }

  // ===== mapa =====
  var map, baseOSM, sat, roads, heatLayer, centroidLayer, polygonLayer, eventsLayer, circleLayer, delitosLayer;
  var filterChipCtrl = null, filterChipEl = null;

  initMap();

  function initMap(){
    map = L.map('map').setView([-32.889, -68.845], 12);
    baseOSM = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    map.createPane('pane-polys');     map.getPane('pane-polys').style.zIndex = 200; map.getPane('pane-polys').style.pointerEvents = 'none';
    map.createPane('pane-circles');   map.getPane('pane-circles').style.zIndex = 210;
    map.createPane('pane-events');    map.getPane('pane-events').style.zIndex = 220;
    map.createPane('pane-delitos');   map.getPane('pane-delitos').style.zIndex = 230;
    map.createPane('pane-centroids'); map.getPane('pane-centroids').style.zIndex = 300;

    sat   = L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']});
    roads = L.tileLayer('https://{s}.google.com/vt/lyrs=h&x={x}&y={y}&z={z}', {maxZoom: 20, subdomains:['mt0','mt1','mt2','mt3']});

    document.getElementById('btnBase').onclick = function(){
      map.addLayer(baseOSM); map.removeLayer(sat); map.removeLayer(roads);
      setBtnState('btnBase', true); setBtnState('btnHybrid', false);
    };
    document.getElementById('btnHybrid').onclick = function(){
      map.removeLayer(baseOSM); sat.addTo(map); roads.addTo(map);
      setBtnState('btnBase', false); setBtnState('btnHybrid', true);
    };

    document.getElementById('btnHeat').onclick = function(){
      if (heatLayer) {
        map.removeLayer(heatLayer); heatLayer=null; setBtnState('btnHeat', false);
      } else {
        heatLayer = L.heatLayer(buildHeatDataDelitos(filteredDelitosDays), {radius:HEAT_RADIUS, blur:15, maxZoom:18}).addTo(map);
        setBtnState('btnHeat', true);
      }
    };
    document.getElementById('btnPolys').onclick = function(){
      if (!polygonLayer) return;
      if (map.hasLayer(polygonLayer)) { map.removeLayer(polygonLayer); setBtnState('btnPolys', false); }
      else { polygonLayer.addTo(map); setBtnState('btnPolys', true); }
    };
    document.getElementById('btnCircles').onclick = function(){
      if (!circleLayer) return;
      if (map.hasLayer(circleLayer)) { map.removeLayer(circleLayer); setBtnState('btnCircles', false); }
      else { circleLayer.addTo(map); setBtnState('btnCircles', true); }
    };
    document.getElementById('btnDelitos').onclick = function(){
      if (!delitosLayer) delitosLayer = makeDelitosLayer(filteredDelitosDays);
      if (map.hasLayer(delitosLayer)) { map.removeLayer(delitosLayer); setBtnState('btnDelitos', false); }
      else { delitosLayer.addTo(map); setBtnState('btnDelitos', true); }
    };

    filterChipCtrl = L.control({position:'topright'});
    filterChipCtrl.onAdd = function(){
      filterChipEl = L.DomUtil.create('div', 'filter-chip leaflet-control');
      filterChipEl.style.display = 'none';
      filterChipEl.innerHTML = '';
      return filterChipEl;
    };
    filterChipCtrl.addTo(map);

    renderMap(filterRows());

    setBtnState('btnBase', true);
    setBtnState('btnHybrid', false);
    setBtnState('btnPolys', true);
    setBtnState('btnCircles', true);
    setBtnState('btnDelitos', false);
    setBtnState('btnHeat', false);
  }

  function buildHeatDataDelitos(arr){
    return (arr||[]).filter(function(p){ return isFinite(p.lat) && isFinite(p.lng); }).map(function(p){ return [p.lat, p.lng, 1]; });
  }

  function makeDelitosLayer(arr){
    const g = L.layerGroup();
    (arr||[]).forEach(function(p){
      if (!isFinite(p.lat) || !isFinite(p.lng)) return;
      const t = '<b>' + (p.jurisdiccion||'') + '</b> ‚Äî ' + ((p.evento||p.delito)||'') + (p.fecha? ('<br><i>'+fmtFecha(p.fecha)+'</i>') : '');
      L.circleMarker([p.lat, p.lng], {
        radius:POINT_RADIUS, color:'#c0392b', weight:1, fillColor:'#e74c3c', fillOpacity:.8,
        pane:'pane-delitos'
      })
      .bindTooltip(t, {direction:'top', offset:[0,-6]})
      .addTo(g);
    });
    return g;
  }

  function renderMap(arr){
    if (centroidLayer) { map.removeLayer(centroidLayer); }
    if (polygonLayer)  { map.removeLayer(polygonLayer); }
    if (eventsLayer)   { map.removeLayer(eventsLayer); }
    if (circleLayer)   { map.removeLayer(circleLayer); }
    if (delitosLayer)  { map.removeLayer(delitosLayer); }
    if (heatLayer)     { map.removeLayer(heatLayer); heatLayer=null; }

    centroidLayer = L.layerGroup().addTo(map);
    polygonLayer  = L.layerGroup().addTo(map);
    eventsLayer   = L.layerGroup().addTo(map);
    circleLayer   = L.layerGroup().addTo(map);
    delitosLayer  = makeDelitosLayer(filteredDelitosDays);

    const bounds = [];

    arr.forEach(function(r){
      if (r.Poligono_WKT) {
        try {
          const gj = wellknown.parse(r.Poligono_WKT);
          const poly = L.geoJSON(gj, {style:{color:'#0d6efd', weight:2, fillOpacity:.05}, interactive:false, pane:'pane-polys'}).addTo(polygonLayer);
          try { bounds.push(poly.getBounds()); } catch(e){}
        } catch(e){}
      }

      if (isFinite(r.Centroide_lat) && isFinite(r.Centroide_lng)) {
        L.circleMarker([r.Centroide_lat, r.Centroide_lng], {
          radius:6, color:'#0d6efd', weight:2, fillColor:'#0d6efd', fillOpacity:.7, pane:'pane-centroids'
        })
        .bindTooltip(buildTooltip(r), {direction:'top', offset:[0,-6]})
        .addTo(centroidLayer);
        bounds.push(L.latLngBounds([ [r.Centroide_lat, r.Centroide_lng], [r.Centroide_lat, r.Centroide_lng] ]));

        const rad = (Number(r.Radio_m)||0) > 0 ? Number(r.Radio_m) : 450;
        L.circle([r.Centroide_lat, r.Centroide_lng], {radius: rad, color:'#0d6efd', weight:1, fillOpacity:0.03, interactive:false, pane:'pane-circles'}).addTo(circleLayer);
      }

      if (r.Eventos_puntos) {
        const pts = String(r.Eventos_puntos).split(/[|;]+/).map(function(s){ return s.trim(); }).filter(Boolean);
        pts.forEach(function(pt){
          const nums = pt.match(/-?\d+(?:\.\d+)?/g);
          if (!nums || nums.length<2) return;
          const la = Number(nums[0]), ln = Number(nums[1]);
          if (isFinite(la) && isFinite(ln)) {
            L.circleMarker([la,ln], {radius:3, color:'#c0392b', weight:1, fillColor:'#e74c3c', fillOpacity:.6, pane:'pane-events'}).addTo(eventsLayer);
          }
        });
      }
    });

    if (bounds.length) {
      const all = bounds.reduce(function(acc,b){ return acc ? acc.extend(b) : b; }, null);
      if (all) map.fitBounds(all.pad(0.15));
      setBtnState('btnPolys', true);
      setBtnState('btnCircles', true);
      setBtnState('btnDelitos', false);
      setBtnState('btnHeat', !!(heatLayer && map.hasLayer(heatLayer)));
    }
  }

  /* === REEMPLAZO: Tooltip + Tabla (ASCII seguro) === */
  function buildTooltip(r){
    var zona   = r.Zona_centroide || '';
    var calles = r.Calles_triangulacion || '';
    var chip   = [r.Distrito, r.Comisaria].filter(function(x){return !!x;}).join(' / ');
    var rangoOp= r.Rango_operativo_SAT || r.Rango_horario_total || '';
    var confL  = r.Confiabilidad_leyenda ? ('<br><b>Confiabilidad:</b> ' + r.Confiabilidad_leyenda) : '';
    var linkPat= r.Link_Patrullaje_URL ? ('<br><b>Patrullaje:</b> <a href="' + r.Link_Patrullaje_URL + '" target="_blank">Ver</a>') : '';
    return '<div><b>' + chip + '</b><br>'
         + '<b>Zona:</b> ' + zona + '<br>'
         + '<b>Poligono:</b> ' + calles + '<br>'
         + '<b>Horario operativo:</b> ' + rangoOp + '<br>'
         + '<b>Radio:</b> ' + (r.Radio_m || '') + ' m - <b>Eventos:</b> ' + (r.Cantidad_eventos || 0)
         + confL + linkPat + '</div>';
  }

  var TB = document.getElementById('tbody');

  function renderTable(arr){
    TB.innerHTML = '';
    arr.forEach(function(r, idx){
      var link    = r.Link_GMaps_URL ? '<a href="' + r.Link_GMaps_URL + '" target="_blank">Mapa</a>' : '';
      var linkPat = r.Link_Patrullaje_URL ? '<a href="' + r.Link_Patrullaje_URL + '" target="_blank">Patrullaje</a>' : '';
      var btnWA   = '<button class="btn btn-sm btn-whatsapp" onclick="shareWA(' + idx + ')">WhatsApp</button>';
      var btnPDF  = '<button class="btn btn-sm btn-outline-dark" onclick="makePDF(' + idx + ')">PDF</button>';
      var rangoOp = r.Rango_operativo_SAT || r.Rango_horario_total || '';

      TB.innerHTML += ''
        + '<tr>'
        +   '<td>' + (r.Distrito || '') + '</td>'
        +   '<td>' + (r.Comisaria || '') + '</td>'
        +   '<td>' + (r.Zona_centroide || '') + '</td>'
        +   '<td>' + (r.Franja || '') + '</td>'
        +   '<td>' + (rangoOp || '') + '</td>'
        +   '<td>' + (r.Radio_m || '') + '</td>'
        +   '<td>' + (r.Cantidad_eventos || 0) + '</td>'
        +   '<td class="d-flex gap-1 flex-wrap">' + link + ' ' + linkPat + ' ' + btnWA + ' ' + btnPDF + '</td>'
        + '</tr>';
    });
  }

  function updateFilterChip(){
    if (!filterChipEl) return;

    const parts = [];
    const elDia    = document.getElementById('fDia');     const diaSel    = (elDia && elDia.value) || '';
    const elFran   = document.getElementById('fFranja');  const franjaSel = (elFran && elFran.value) || '';
    const elComis  = document.getElementById('fComis');   const comisSel  = (elComis && elComis.value) || '';
    const elVent   = document.getElementById('fVentana'); const ventVal   = (elVent && elVent.value) || '';
    const elDesde  = document.getElementById('fDesde');   const ds        = (elDesde && elDesde.value) || '';
    const elHasta  = document.getElementById('fHasta');   const hs        = (elHasta && elHasta.value) || '';

    if (diaSel)    parts.push(diaSel);
    if (franjaSel) parts.push(franjaSel);
    if (comisSel)  parts.push('Distrito: ' + comisSel);
    if (ds || hs) {
      const fmt = function(s){ try { return new Date(s).toLocaleDateString('es-AR'); } catch(e){ return s; } };
      const rango = (ds? fmt(ds):'') + ((ds||hs)? ' ‚Äì ' : '') + (hs? fmt(hs):'');
      parts.push(rango.trim());
    }
    if (ventVal) {
      const labelmap = { '1':'24 hs', '2':'48 hs', '3':'72 hs', '7':'7 d√≠as', '15':'15 d√≠as' };
      parts.push('Eventos: ' + (labelmap[ventVal] || (ventVal + ' d√≠as')));
    }

    if (parts.length){
      filterChipEl.innerHTML = '<b>Filtro:</b> ' + parts.join(' ‚Ä¢ ');
      filterChipEl.style.display = '';
    } else {
      filterChipEl.style.display = 'none';
      filterChipEl.innerHTML = '';
    }
  }

  function renderAll(){
    const arr = filterRows();
    LAST_ROWS = arr.slice();

    filteredDelitosDays = getFilteredDelitos();

    renderMap(arr);
    const kA = arr.length;
    const kE = arr.reduce(function(a,r){ return a + (Number(r.Cantidad_eventos)||0); }, 0);
    document.getElementById('kpiAlertas').textContent = kA;
    document.getElementById('kpiEventos').textContent = kE;
    renderTable(arr);

    const elDia = document.getElementById('fDia');
    const diaSel = (elDia && elDia.value) || '';
    const kpiDia = document.getElementById('kpiDia');
    const kpiDiaVal = document.getElementById('kpiDiaVal');
    if (kpiDia && kpiDiaVal) {
      if (diaSel) { kpiDiaVal.textContent = diaSel; kpiDia.classList.remove('d-none'); }
      else { kpiDia.classList.add('d-none'); kpiDiaVal.textContent = ''; }
    }

    updateFilterChip();
  }

  // =======================
  // WhatsApp ‚Äì Formato + Ruta sugerida
  // =======================
  function waEmoji(name){
    if (name === 'shield') return 'üõ°Ô∏è ';
    if (name === 'pin')    return 'üìç ';
    if (name === 'road')   return 'üõ£Ô∏è ';
    return '';
  }

  // Ruta sugerida (RegExp constructor: seguro dentro de template literal)
  function buildRutaSugerida(pol){
    var s = String(pol||'').trim();
    if (!s) return 's/d';
    // \s -> s ; \/ -> / ; \\| -> |
    var sep = new RegExp("\\s*(?:\/|->|‚Üí|\\|;)\\s*");
    var pts = s.split(sep).filter(function(x){ return !!x; });
    if (!pts.length) return 's/d';
    if (pts.length === 1) return 'Punto fijo: ' + pts[0];
    return pts.join(' -> ') + ' -> ' + pts[0] + ' (circuito)';
  }

  // Sanitizador ASCII para WhatsApp
  function sanitizeASCII(s){
    s = String(s||'');
    s = s.replace(/[ÔøΩ-ÔøΩ][ÔøΩ-ÔøΩ]/g,''); // emojis tipo surrogate
    s = s.replace(/[Ô∏è‚Äç]/g,'');                 // variation selector / ZWJ
    s = s.replace(/¬†/g,' ').replace(/[‚Äì‚Äî]/g,'-');   // NBSP y guiones largos
    return s.trim();
  }

  function bestLink(r){
    return r.Link_GMaps_URL || r.Link_Patrullaje_URL || 's/d';
  }

  // WhatsApp por fila
  window.shareWA = function(idx){
    var r = LAST_ROWS[idx];
    if (!r) return;

    var chip    = sanitizeASCII([r.Distrito, r.Comisaria].filter(Boolean).join(' / ') || 's/d');
    var dia     = sanitizeASCII(r.D√≠a || r.Dia || 's/d');
    var franja  = sanitizeASCII(r.Franja || 's/d');
    var rangoOp = sanitizeASCII(r.Rango_operativo_SAT || r.Rango_horario_total || 's/d');
    var confTxt = sanitizeASCII(r.Confiabilidad_leyenda || 's/d');
    var zona    = sanitizeASCII(r.Zona_centroide || 's/d');
    var radio   = sanitizeASCII(String(r.Radio_m || 0)) + ' m';
    var ruta    = sanitizeASCII(buildRutaSugerida(r.Calles_triangulacion || ''));
    var link    = sanitizeASCII(bestLink(r));

    var lines = [
      'üõ°Ô∏è PATRULLAJE SAT - ' + (chip || 's/d') + '',
      '_____________',
      'Orden de Policiamiento:',
      'D√≠a: ' + dia + '  ¬∑  Franja: ' + franja,
      'Rango operativo: ' + rangoOp + ' - Confiabilidad: ' + confTxt,
      'üìç Zona: ' + zona + ' - Radio: ' + radio,
      'üõ£Ô∏è Ruta sugerida: ' + ruta,
      'Instrucciones: Patrullar cada 20 min con detenci√≥n breve y balizas encendidas.',
      'Clic Ver Patrullaje Sugerido: ' + link,
      'Observaciones: Velocidad sugerida 20 km/h. Reportar novedades en SAT y a su superior.'
    ];

    var msg = lines.join('\n');
    window.open('https://wa.me/?text=' + encodeURIComponent(msg), '_blank');
  };

  // ===== PDF por fila =====
  window.makePDF = async function(idx){
    const r = LAST_ROWS[idx];
    if (!r) return;
    const rangoOp = r.Rango_operativo_SAT || r.Rango_horario_total || '';
    const confL = r.Confiabilidad_leyenda ? ('<div><b>Confiabilidad:</b> '+r.Confiabilidad_leyenda+'</div>') : '';
    const box = document.createElement('div');
    box.style.position='fixed'; box.style.top='-9999px'; box.style.left='-9999px';
    box.style.width='600px'; box.style.padding='16px'; box.style.background='#fff'; box.style.border='1px solid #ddd';
    box.innerHTML = `
      <h5>SAT ‚Äì Sistema de An√°lisis Territorial</h5>
      <div><b>Distrito/Comisar√≠a:</b> ${[r.Distrito,r.Comisaria].filter(Boolean).join(' / ')}</div>
      <div><b>Zona:</b> ${r.Zona_centroide}</div>
      <div><b>Pol√≠gono:</b> ${r.Calles_triangulacion}</div>
      <div><b>Horario operativo:</b> ${rangoOp}</div>
      <div><b>Radio (m):</b> ${r.Radio_m || ''} ¬∑ <b>Eventos:</b> ${r.Cantidad_eventos || 0}</div>
      <div><b>Mapa:</b> ${r.Link_GMaps_URL ? r.Link_GMaps_URL : (r.Link_Patrullaje_URL ? r.Link_Patrullaje_URL : '(s/d)')} </div>
      ${confL}
      <br>
      <div>üìù <b>Directiva:</b><br>Patrullar cada 20 min con detenci√≥n breve y balizas encendidas.</div>
      <div>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</div>
      <div>‚ö†Ô∏è Recuerda patrullar a 20 km/h y reportar novedades en SAT y a tu Superior</div>
      <br><div class="small">¬© SAT ‚Äì Oficina de Estad√≠sticas y An√°lisis Delictual y Operacional</div>
    `;
    document.body.appendChild(box);
    const canvas = await html2canvas(box);
    document.body.removeChild(box);
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p','pt','a4');
    const pageW = pdf.internal.pageSize.getWidth();
    const ratio = (pageW - 40) / canvas.width;
    pdf.addImage(imgData, 'PNG', 20, 20, canvas.width*ratio, canvas.height*ratio);
    pdf.save('SAT_Patrullaje_'+(r.Distrito||'')+'_'+(r.Zona_centroide||'')+'.pdf');
  };

  // Render inicial
  renderAll();
  </script>

</body>
</html>